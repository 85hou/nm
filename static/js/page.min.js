+function(t){"use strict";var n={queue:[],current:null,bomb:0,debug:!1},a=[],e=function(t){n.debug&&console.log(t)},s=function(t){if(!isFinite(t)||0>t)t="--:--";else{var n=Math.floor(t/60);t=Math.floor(t)%60,t=(10>n?"0"+n:n)+":"+(10>t?"0"+t:t)}return t},r=function(n){var a="";t.each(n,function(t,n){a+='<li class="nm-songlist-item"><span class="song-info">'+n.title+" - "+n.artist+'</span><span class="song-time">'+s(n.duration)+"</span></li>"}),t(".nm-songlist").html(a)},i=function(){var s=this;this.options={selector:"#nm_jplayer"},this.player=this.options.selector,s.init(),t(document).on("click",".nm-list-item",function(){var i=t(this);if(!i.hasClass("is-active")){t(".nm-list-item").removeClass("is-active"),i.addClass("is-active");var l=i.children(".nm-list-content").find(".music-info").text(),o=i.children(".nm-list-content").find(".music-cover").attr("src"),u=i.data("id"),c="dick"+u,m=t(".nm-songs"),p=nm_ajax_url.tworow?" threerow":"";t(".nmplaybar").addClass("appear");var d='<div class="fucker"></div><div class="nm-songs"><div class="nm-songs-title nm-container">'+l+'</div><div class="nm-songs-list nm-container"><ul class="nm-songlist'+p+'"></ul></div></div>';m.remove(),i.parent().after(d),n.current=c,t(".nmplayer-cover").css("background-image","url("+o+")"),a[c]?(r(a[c]),s.play(c,0)):t.ajax({type:"post",dataType:"json",url:nm_ajax_url.ajax_url,data:{action:"nmjson",id:u},success:function(t){if(200==t.msg){t=t.song;var n=t.songs;r(n),a["dick"+u]=n,s.play(c,0)}}}),e(n.current)}}),t(s.player).bind(t.jPlayer.event.play,function(){var e=a[n.current][n.bomb];t(".nm-songlist-item").removeClass("current"),t(".nm-songlist-item").data("status","ready").removeClass("pause"),t(".nm-songlist-item").eq(n.bomb).data("status","play"),t(".nm-songlist-item").eq(n.bomb).addClass("current"),t(".nmplayer-title").html(e.title+" - "+e.artist),t(".nms-play-btn").removeClass("nm-play").addClass("nm-pause")}),t(s.player).bind(t.jPlayer.event.pause,function(){a[n.current][n.bomb];t(".nm-songlist-item").eq(n.bomb).data("status","pause").addClass("pause"),t(".nms-play-btn").removeClass("nm-pause").addClass("nm-play")}),t(s.player).bind(t.jPlayer.event.ended,function(){n.bomb<a[n.current].length?(n.bomb=n.bomb+1,s.play(n.current,n.bomb),t(s.player).jPlayer("play")):n.bomb=0}),t(document).on("click",".nm-songlist-item",function(){var a=t(this),r=a.index();"play"==a.data("status")?s.pause():"pause"==a.data("status")?s.play():(s.play(n.current,r),e("play "+r))}),t(".jp-progress").on("click",function(e){e.preventDefault();var r=t(this),i=r.offset().left,l=(e.pageX-i)/r.width(),o=a[n.current][n.bomb].duration;t(s.player).jPlayer("play",o*l)}),t(document).on("click",".nms-play-btn",function(){var n=t(this);n.hasClass("nm-play")?(e("player continue."),s.play()):(e("player pause."),s.pause())}),t(document).on("click",".nm-loadmore",function(){var n=t(this),a=n.data();n.hasClass("is-active")||(n.addClass("is-active"),t.ajax({url:nm_ajax_url.ajax_url,type:"POST",dataType:"json",data:a,success:function(a){return 200!=a.status?e("error"):(t(".nm-wrapper").append(a.data),a.nav?n.data("paged",a.nav):n.remove(),void n.removeClass("is-active"))}}))}),t(document).on("click",".nm-previous",function(){t(this);e("previous"),s.previous()}),t(document).on("click",".nm-next",function(){t(this);e("next"),s.next()})};i.prototype={init:function(){t(this.player).jPlayer({timeupdate:function(e){var r,r=e.jPlayer.status.currentTime,r=s(r),i=a[n.current][n.bomb].lrc,l=parseInt(e.jPlayer.status.currentTime);void 0!=i[l]&&t(".nmplayer-lrc").html(i[l]),t(".nmplayer-time").text(r),t(".nmplayer-prosess").css("transform","translateX("+(e.jPlayer.status.currentPercentAbsolute-100)+"%)")},supplied:"mp3",swfPath:nm_ajax_url.swfurl,solution:"html,flash",volume:1})},getJSON:function(n){t.ajax({type:"post",dataType:"json",url:nm_ajax_url.ajax_url,data:{action:"nmjson",id:n},success:function(t){if(200==t.msg){t=t.song;var e=t.songs;return a["dick"+n]=e,e}}})},play:function(n,a){"undefined"!=typeof n&&"undefined"!=typeof a&&this.select(n,a),t(this.player).jPlayer("play")},select:function(e,s){n.current=e,n.bomb=s,t(this.player).jPlayer("setMedia",a[n.current][n.bomb])},pause:function(){t(this.player).jPlayer("pause")},next:function(){var t=a[n.current].length;n.bomb!=t-1&&this.play(n.current,n.bomb+1)},previous:function(){n.bomb<1||(e(n.bomb),this.play(n.current,n.bomb-1))}};new i}(jQuery);